<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<script>
    const obj = {
        arr: [111, 222],
        obj: {key: '对象'},
        a: () => {console.log('函数')},
        date: new Date(),
        reg: /正则/ig
    }

    var obj2=JSON.parse(JSON.stringify(obj));
    console.log(obj2);


    function deepCopy(obj, hash = new WeakMap()) {
        let cloneObj;
        let Constructor = obj.constructor;
        switch(Constructor){
            case RegExp:
                cloneObj = new Constructor(obj);
                break;
            case Date:
                cloneObj = new Constructor(obj.getTime());
                break;
            case Function:
                cloneObj = eval(obj.toString());  // 只可以是箭头函数，普通函数出错
                break;
            default:
                if(hash.has(obj)) return hash.get(obj);
                cloneObj = new Constructor();
                hash.set(obj, cloneObj)
        }
        for (let key in obj) {
            cloneObj[key] = isObj(obj[key]) ? deepCopy(obj[key], hash) : obj[key];
        }
        return cloneObj;
    }
    function isObj(obj) {
        return (typeof obj === 'object' || typeof obj === 'function') && obj !== null
    }
    console.log(deepCopy(obj))


</script>

</body>
</html>